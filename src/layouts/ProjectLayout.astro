---
import Layout from "./Layout.astro";
import { Image } from "astro:assets";
import SkillBadge from "../components/SkillBadge.astro";

const base = import.meta.env.BASE_URL;
const normalizedBase = base.endsWith("/") ? base : `${base}/`;

interface Props {
  title: string;
  description: string;
  startDate: Date;
  endDate?: Date;
  image: any;
  skills: string[];
  demoLink?: string;
  sourceLink?: string;
}

const {
  title,
  description,
  image,
  skills,
} = Astro.props;
---

<Layout title={title} description={description}>
  <article class="max-w-4xl mx-auto px-4 py-20">
    <!-- Back button -->
    <div class="mb-8">
      <a href={`${normalizedBase}projects`} class="btn btn-ghost btn-sm">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="20"
          height="20"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
        >
          <path d="m15 18-6-6 6-6"></path>
        </svg>
        Torna ai Disturbi
      </a>
    </div>

    <!-- Featured Image -->
    {
      image && (
        <figure class="mb-8 rounded-2xl overflow-hidden bg-base-300">
          <Image
            src={image}
            alt={title}
            class="w-full max-h-96 object-contain p-4 mx-auto"
            width={800}
            height={600}
          />
        </figure>
      )
    }

    <!-- Header -->
    <header class="mb-8">
      <h1 class="text-5xl font-bold mb-4">{title}</h1>
      <p class="text-xl text-base-content/70 mb-6">{description}</p>
    </header>

    <!-- Ambiti trattati -->
    {
      skills && skills.length > 0 && (
        <div class="card bg-base-200 mb-8">
          <div class="card-body">
            <h2 class="card-title text-lg mb-3">Ambiti trattati</h2>
            <div class="flex flex-wrap gap-2">
              {skills.map((skill) => (
                <SkillBadge skill={skill} />
              ))}
            </div>
          </div>
        </div>
      )
    }

    <!-- Divider -->
    <div class="divider"></div>

    <!-- Content -->
    <div class="prose prose-lg max-w-none">
      <slot />
    </div>

    <!-- Divider -->
    <div class="divider mt-12"></div>

    <!-- Back to projects link -->
    <div class="text-center mt-8">
      <a href={`${normalizedBase}projects`} class="btn btn-primary"> Tutti i Disturbi Trattati </a>
    </div>
  </article>
</Layout>
